# 문서 JSON 스키마

이 문서는 `docx_parsing_pipeline.py`에 의해 생성된 JSON 파일의 스키마를 설명합니다. 이 JSON은 DOCX 파일의 구조화된 콘텐츠를 나타냅니다.

## 최상위 구조

JSON 객체는 다음과 같은 최상위 키를 가지고 있습니다:

- `paragraphs` (리스트): 단락 객체의 리스트입니다.
- `drawings` (리스트): 도형, 이미지 등 드로잉 객체의 리스트입니다.
- `tables` (리스트): 표 객체의 리스트입니다.
- `headers` (리스트): 문서의 머리글 객체 리스트입니다.
- `footers` (리스트): 문서의 바닥글 객체 리스트입니다.
- `relationships` (딕셔너리): 문서의 다른 부분 간의 관계에 대한 정보를 담고 있는 딕셔너리입니다.
- `inline_images` (리스트): 텍스트 줄 안에 포함된 이미지 객체의 리스트입니다.

---

## `paragraph` 객체

하나의 텍스트 단락을 나타냅니다.

| 키 | 타입 | 설명 |
|---|---|---|
| `text` | 문자열 | 단락의 일반 텍스트 내용입니다. |
| `index` | 정수 | 문서에서 단락의 0부터 시작하는 인덱스입니다. |
| `style` | 문자열 | 단락의 스타일입니다 (예: "Heading 1", "Normal"). |
| `runs` | 리스트 | 단락을 구성하는 `run` 객체의 리스트입니다. |
| `numId` | 문자열 | null | 단락이 목록의 일부인 경우 번호 매기기 정의의 ID입니다. |
| `ilvl` | 정수 | null | 목록 항목의 들여쓰기 수준입니다. |
| `numFmt` | 문자열 | null | 목록 항목의 숫자 형식입니다 (예: "decimal", "bullet"). |
| `list_type` | 문자열 | null | 목록의 유형입니다 (예: "ordered", "unordered"). |

### `run` 객체

동일한 서식을 가진 연속된 텍스트의 실행을 나타냅니다.

| 키 | 타입 | 설명 |
|---|---|---|
| `text` | 문자열 | 실행의 텍스트 내용입니다. |
| `b` | 불리언 | 텍스트가 굵게 표시되는지 여부입니다. |
| `i` | 불리언 | 텍스트가 기울임꼴인지 여부입니다. |
| `u` | 불리언 | 텍스트에 밑줄이 있는지 여부입니다. |
| `rStyle` | 문자열 | 실행의 문자 스타일입니다. |
| `sz` | 실수 | null | 포인트 단위의 글꼴 크기입니다. |
| `color` | 문자열 | null | 텍스트의 16진수 색상입니다. |

---

## `drawing` 객체

도형이나 텍스트 상자와 같은 드로잉 요소를 나타냅니다.

| 키 | 타입 | 설명 |
|---|---|---|
| `did` | 문자열 | 드로잉 객체의 고유 ID입니다. |
| `kind` | 문자열 | 드로잉의 종류입니다 (예: "shape", "image"). |
| `preset` | 문자열 | 도형의 사전 설정된 기하학적 모양입니다 (예: "rect", "rightArrow"). |
| `anchor_type` | 문자열 | 앵커 유형입니다 (예: "anchor"). |
| `rel_from_h` | 문자열 | 위치 지정을 위한 수평 참조입니다 (예: "column"). |
| `rel_from_v` | 문자열 | 위치 지정을 위한 수직 참조입니다 (예: "paragraph"). |
| `pos_offset` | 딕셔너리 | 오프셋의 `x` 및 `y` 좌표를 가진 객체입니다. |
| `extent` | 딕셔너리 | 드로잉의 `w`(너비)와 `h`(높이)를 가진 객체입니다. |
| `wrap` | 문자열 | 텍스트 줄 바꿈 스타일입니다 (예: "wrapNone"). |
| `z` | 정수 | 드로잉의 z-순서입니다. |
| `context` | 딕셔너리 | 드로잉의 위치에 대한 정보입니다 (예: 단락 인덱스). 문서 내 drawing 인덱스도 포함(doc_index)|
| `text` | 딕셔너리 | 드로잉의 텍스트 내용입니다. |
| `connector` | 딕셔너리 | 도형의 연결선 속성에 대한 정보입니다. |
| `xfrm` | 딕셔너리 | 변환 정보 (오프셋, 범위, 회전)입니다. |
| `simple_pos` | 딕셔너리 | 간단한 위치 정보입니다. |
| `position_confidence` | 실수 | 드로잉 위치에 대한 신뢰도 점수입니다. |
| `page_hint` | 정수 | 드로잉이 위치한 페이지 번호에 대한 힌트입니다. |
| `group_hierarchy` | 딕셔너리 | 도형 그룹화에 대한 정보입니다. |
| `image` | null | (현재 null이며, 향후 이미지 데이터를 포함할 수 있습니다). |
| `provenance` | 딕셔너리 | 드로잉의 소스 XML에 대한 정보입니다. |

---

## `table` 객체

문서의 표를 나타냅니다.

| 키 | 타입 | 설명 |
|---|---|---|
| `tid` | 문자열 | 표의 고유 ID입니다. |
| `rows` | 정수 | 표의 행 수입니다. |
| `cols` | 정수 | 표의 열 수입니다. |
| `data` | 리스트 | 셀 데이터를 나타내는 2D 문자열 리스트입니다. |

---

## `header` 및 `footer` 객체

문서 섹션의 머리글과 바닥글을 나타냅니다.

| 키 | 타입 | 설명 |
|---|---|---|
| `part` | 문자열 | 머리글/바닥글의 XML 부분 경로입니다 (예: "word/header1.xml"). |
| `text` | 문자열 | 머리글/바닥글의 일반 텍스트 내용입니다. |

---

## `relationship` 객체

문서의 `.rels` 파일에 정의된 관계를 나타냅니다.

`relationships` 객체는 단일 키 `map`을 포함하며, 이 맵은 각 키가 관계 ID(`rId`)이고 값이 다음 속성을 가진 객체인 딕셔너리입니다:

| 키 | 타입 | 설명 |
|---|---|---|
| `rid` | 문자열 | 관계 ID입니다. |
| `type` | 문자열 | 관계 유형의 URI입니다. |
| `target` | 문자열 | 관계의 대상 파일입니다. |

---

## `inline_image` 객체

텍스트 줄 안에 포함된 이미지를 나타냅니다. 예제에서는 현재 리스트가 비어 있지만, 향후 사용을 위해 스키마가 정의되어 있습니다.